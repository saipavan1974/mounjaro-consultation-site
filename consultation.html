<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Consultation & Payment - PharmaLogic</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://js.stripe.com/v3/"></script>
</head>
<body class="bg-gray-100 text-gray-800">

  <!-- HEADER -->
  <div class="bg-green-900 text-white px-6 py-4 flex items-center justify-between shadow-md">
    <a href="index.html"><img src="logo.jpeg" alt="PharmaLogic Logo" class="h-10" /></a>
    <a href="index.html" class="bg-white text-blue-900 font-semibold px-4 py-2 rounded hover:bg-gray-100">Home</a>
  </div>

  <!-- FORM -->
  <div class="max-w-4xl mx-auto p-6 bg-white shadow-md mt-10 rounded-lg">
    <h1 class="text-3xl font-bold mb-6 text-center text-blue-800">Start Consultation & Payment</h1>

    <form id="consultation-form">
    <!-- Step 1: Consultation & Medical Info -->
      <fieldset id="step-1">
        <legend class="font-bold mb-4 text-xl text-gray-700">Patient Consultation & Medical History</legend>

        <!-- Patient Info -->
        <label class="block mb-3">
          Full Name*:
          <input type="text" name="patient_name" required class="border p-2 w-full rounded" />
        </label>
        <label class="block mb-3">
          Date of Birth*:
          <input type="date" name="dob" required class="border p-2 w-full rounded" />
        </label>
        
        <label class="block mb-3">
           Are you on mounjaro or not?*:
          <select name="Are you on mounjaro or not" required class="border p-2 w-full rounded">
            <option value="">Select...</option>
            <option value="Yes">Yes</option>
            <option value="No">No</option>
          </select>
        </label>        
        <!-- Medical Screening -->
        <label class="block mb-3">
          Weight (kg)*:
          <input type="number" name="weight" id="weight" step="0.1" required class="border p-2 w-full rounded" />
        </label>
        <label class="block mb-3">
          Height (cm)*:
          <input type="number" name="height" id="height" step="0.1" required class="border p-2 w-full rounded" />
        </label>
        <label class="block mb-3">
          Calculated BMI:
          <input type="text" id="bmi" name="bmi" readonly class="border p-2 w-full rounded bg-gray-100" />
        </label>

        <label class="block mb-3">
          Do you have a BMI over 30, or over 27?*
          <select name="bmi_criteria" required class="border p-2 w-full rounded">
            <option value="">Select...</option>
            <option value="Yes">Yes</option>
            <option value="No">No</option>
          </select>
        </label>

        <label class="block mb-3">
          Do you have diabetes?*
          <select name="t2d" required class="border p-2 w-full rounded">
            <option value="">Select...</option>
            <option value="Yes">Yes</option>
            <option value="No">No</option>
          </select>
        </label>

        <label class="block mb-3">
          Are you currently pregnant, breastfeeding, or planning to become pregnant?*
          <select name="pregnancy" required class="border p-2 w-full rounded">
            <option value="">Select...</option>
            <option value="No">No</option>
            <option value="Yes">Yes</option>
          </select>
        </label>

        <label class="block mb-3">
          Do you have any of the following conditions? (tick all that apply)
          <div class="mt-1 space-y-1 text-sm">
            <label><input type="checkbox" name="conditions" value="Thyroid cancer" /> Thyroid cancer (personal or family history)</label><br />
            <label><input type="checkbox" name="conditions" value="Pancreatitis" /> Pancreatitis</label><br />
            <label><input type="checkbox" name="conditions" value="Kidney/liver disease" /> Kidney or liver disease</label><br />
            <label><input type="checkbox" name="conditions" value="Eating disorder" /> History of eating disorder</label><br />
            <label><input type="checkbox" name="conditions" value="None" /> None</label>
          </div>
        </label>

        <label class="block mb-3">
          Are you currently taking any medications? If yes, please list them:
          <textarea name="medications" class="border p-2 w-full rounded"></textarea>
        </label>

        <!-- Mounjaro Strength & Uploads -->
        <label class="block mb-3 font-semibold">
          Which strength of Mounjaro are you looking for?*
          <select name="mounjaro_strength" id="mounjaro_strength" required class="border p-2 w-full rounded">
            <option value="">Select one</option>
            <option value="2.5mg">2.5mg</option>
            <option value="5mg">5mg</option>
            <option value="7.5mg">7.5mg</option>
            <option value="10mg">10mg</option>
            <option value="12.5mg">12.5mg</option>
            <option value="15mg">15mg</option>
          </select>
        </label>

        <div id="proof-id" class="mb-4 hidden">
          <label class="block mb-2 font-semibold">Upload Valid Proof of ID</label>
          <input type="file" name="proof_of_id" class="w-full" />
        </div>
        <div id="prescription-div" class="mb-4 hidden">
          <label class="block mb-2 font-semibold">Upload Previous Prescription</label>
          <input type="file" name="previous_prescription" class="w-full" />
        </div>
        <div id="video-div" class="mb-4 hidden">
          <label class="block mb-2 font-semibold">Upload a short video (on scale & verification)</label>
          <input type="file" name="video_upload" accept="video/*" class="w-full" />
        </div>

        <button type="button" id="to-step-2" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded font-semibold mt-4">Next: Billing & Shipping</button>
      </fieldset>

      <!-- Step 2: Billing & Shipping -->
      <!-- ... No changes to this section -->

      <!-- Step 3: Review & Payment -->
      <!-- ... No changes to this section -->
    </form>
  </div>

<script>
document.addEventListener('DOMContentLoaded', function () {
  const form = document.getElementById('consultation-form');
  if (!form) return;

  // ... all logic remains same

  toStep2Btn.addEventListener('click', () => {
    if (!form?.checkValidity?.() || !validatePhone()) {
      form?.reportValidity?.();
      return;
    }
    step1.classList.add('hidden');
    step2.classList.remove('hidden');
    window.scrollTo(0, 0);
  });

  toStep3Btn.addEventListener('click', () => {
    if (!form?.checkValidity?.()) {
      form?.reportValidity?.();
      return;
    }
    populateReview();
    step2.classList.add('hidden');
    step3.classList.remove('hidden');
    window.scrollTo(0, 0);
  });

  form.addEventListener('submit', (e) => {
    e.preventDefault();
    if (!form?.checkValidity?.() || !validatePhone()) {
      form?.reportValidity?.();
      return;
    }
    alert('Form submitted successfully! Redirecting to payment...');
    window.location.href = "https://buy.stripe.com/test_8wM6qt99m4Hv2zO3cc";
  });
});
</script>

</body>
</html>
